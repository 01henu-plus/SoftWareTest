# Checkout å¾®æœåŠ¡æµ‹è¯• - è¯¾åä½œä¸š

## é¡¹ç›®è¯´æ˜
ä¸ºå¾®æœåŠ¡ checkout ç¼–å†™ç³»ç»Ÿæµ‹è¯•è®¡åˆ’ä¸è„šæœ¬ã€‚

## åŠŸèƒ½æè¿°
Checkout å¾®æœåŠ¡æä¾›è´­ç‰©è½¦ç»“ç®—åŠŸèƒ½ï¼š
- æ¥æ”¶å•†å“åˆ—è¡¨ï¼ˆä»·æ ¼å’Œæ•°é‡ï¼‰
- è®¡ç®—æ€»ä»·
- è¿”å›ç»“ç®—ç»“æœ

## é¡¹ç›®ç»“æ„
```
KeHouZuoye/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ checkout_service.py    # Flask å¾®æœåŠ¡
â”œâ”€â”€ test_checkout.py           # pytest æµ‹è¯•è„šæœ¬
â”œâ”€â”€ requirements.txt           # ä¾èµ–æ¸…å•
â””â”€â”€ README.md                  # æœ¬æ–‡ä»¶
```

## å®‰è£…ä¾èµ–

```bash
pip install flask pytest requests
```

æˆ–ä½¿ç”¨ requirements.txt:

```bash
pip install -r requirements.txt
```

## API æ¥å£

### POST /checkout

**è¯·æ±‚æ ¼å¼:**
```json
{
    "items": [
        {"price": 20, "quantity": 3},
        {"price": 15, "quantity": 2}
    ]
}
```

**æˆåŠŸå“åº” (200):**
```json
{
    "total": 90,
    "status": "ok"
}
```

**å¤±è´¥å“åº” (400):**
```json
{
    "error": "empty cart"
}
```

## è¿è¡Œæ–¹å¼

### æ–¹æ³•1: è¿è¡Œæµ‹è¯•è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
python test_checkout.py
```

æµ‹è¯•è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. å¯åŠ¨ Flask æœåŠ¡å™¨
2. æ‰§è¡Œæ‰€æœ‰æµ‹è¯•ç”¨ä¾‹
3. éªŒè¯ç»“æœ
4. å…³é—­æœåŠ¡å™¨

### æ–¹æ³•2: æ‰‹åŠ¨å¯åŠ¨æœåŠ¡å™¨

**ç»ˆç«¯1 - å¯åŠ¨æœåŠ¡:**
```bash
python app/checkout_service.py
```

**ç»ˆç«¯2 - è¿è¡Œ pytest:**
```bash
pytest test_checkout.py -v
```

**ç”Ÿæˆ HTML æŠ¥å‘Š:**
```bash
pytest test_checkout.py --html=report.html --self-contained-html
```

## æµ‹è¯•ç”¨ä¾‹

| æµ‹è¯•ç”¨ä¾‹ | æµ‹è¯•åœºæ™¯ | è¾“å…¥ | æœŸæœ›è¾“å‡º |
|---------|----------|------|----------|
| test_checkout_total | è®¡ç®—è´­ç‰©è½¦æ€»ä»· | 1ä¸ªå•†å“: price=20, quantity=3 | total=60, status="ok" |
| test_checkout_empty_cart | ç©ºè´­ç‰©è½¦ | items=[] | error="empty cart", status=400 |
| test_checkout_multiple_items | å¤šä¸ªå•†å“ | 3ä¸ªå•†å“ | total=100, status="ok" |

## æµ‹è¯•è®¡åˆ’

### 1. åŠŸèƒ½æµ‹è¯•
- âœ… æ­£å¸¸ç»“ç®—æµç¨‹
- âœ… ç©ºè´­ç‰©è½¦å¤„ç†
- âœ… å¤šå•†å“è®¡ç®—

### 2. éªŒè¯ç‚¹
- âœ… HTTP çŠ¶æ€ç æ­£ç¡®
- âœ… è¿”å›æ•°æ®æ ¼å¼æ­£ç¡®
- âœ… æ€»ä»·è®¡ç®—å‡†ç¡®
- âœ… é”™è¯¯å¤„ç†æ­£ç¡®

### 3. æµ‹è¯•ç¯å¢ƒ
- Python 3.14.0
- Flask 3.1.2
- pytest 8.4.2
- requests 2.32.3

## æ‰‹åŠ¨æµ‹è¯•

ä½¿ç”¨ curl æˆ– Postman æµ‹è¯•ï¼š

```bash
# æ­£å¸¸è¯·æ±‚
curl -X POST http://127.0.0.1:5000/checkout \
  -H "Content-Type: application/json" \
  -d '{"items": [{"price": 20, "quantity": 3}]}'

# ç©ºè´­ç‰©è½¦
curl -X POST http://127.0.0.1:5000/checkout \
  -H "Content-Type: application/json" \
  -d '{"items": []}'
```

## é¢„æœŸè¾“å‡º

```
======================================================================
  Checkout å¾®æœåŠ¡æµ‹è¯•
======================================================================

âœ… æµ‹è¯•é€šè¿‡: test_checkout_total
   è¯·æ±‚æ•°æ®: {'items': [{'price': 20, 'quantity': 3}]}
   å“åº”æ•°æ®: {'total': 60, 'status': 'ok'}
   çŠ¶æ€ç : 200

âœ… æµ‹è¯•é€šè¿‡: test_checkout_empty_cart
   è¯·æ±‚æ•°æ®: {'items': []}
   å“åº”æ•°æ®: {'error': 'empty cart'}
   çŠ¶æ€ç : 400

âœ… æµ‹è¯•é€šè¿‡: test_checkout_multiple_items
   è¯·æ±‚æ•°æ®: {'items': [{'price': 20, 'quantity': 3}, ...]}
   å“åº”æ•°æ®: {'total': 100, 'status': 'ok'}
   è®¡ç®—éªŒè¯: 20*3 + 15*2 + 10*1 = 100

======================================================================
  ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡! (3/3)
======================================================================
```

## æŠ€æœ¯è¦ç‚¹

### 1. Flask å¾®æœåŠ¡
- RESTful API è®¾è®¡
- JSON æ•°æ®äº¤äº’
- POST è¯·æ±‚å¤„ç†

### 2. å¤šè¿›ç¨‹æµ‹è¯•
- ä½¿ç”¨ multiprocessing å¯åŠ¨æœåŠ¡å™¨
- ç‹¬ç«‹è¿›ç¨‹é¿å…é˜»å¡
- æµ‹è¯•å®Œæˆåæ¸…ç†è¿›ç¨‹

### 3. pytest é›†æˆ
- ä½¿ç”¨ assert æ–­è¨€
- å¯ç”Ÿæˆ HTML æŠ¥å‘Š
- æ”¯æŒè¯¦ç»†è¾“å‡º

### 4. è¯·æ±‚æµ‹è¯•
- ä½¿ç”¨ requests åº“
- éªŒè¯çŠ¶æ€ç å’Œå“åº”æ•°æ®
- æµ‹è¯•æ­£å¸¸å’Œå¼‚å¸¸åœºæ™¯

## å­¦ä¹ ç›®æ ‡

- âœ… ç†è§£å¾®æœåŠ¡æµ‹è¯•æµç¨‹
- âœ… æŒæ¡ Flask RESTful API å¼€å‘
- âœ… å­¦ä¼šä½¿ç”¨ pytest è¿›è¡Œé›†æˆæµ‹è¯•
- âœ… æŒæ¡å¤šè¿›ç¨‹æµ‹è¯•æŠ€æœ¯
- âœ… ç†è§£ HTTP è¯·æ±‚å’Œå“åº”

## å‚è€ƒèµ„æ–™

- [Flask å®˜æ–¹æ–‡æ¡£](https://flask.palletsprojects.com/)
- [pytest å®˜æ–¹æ–‡æ¡£](https://docs.pytest.org/)
- [requests æ–‡æ¡£](https://requests.readthedocs.io/)
